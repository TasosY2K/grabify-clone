<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Lean Tracker</title>
    include head.pug
    script
      include ./js/tracker.js
  </head>
  <body>
    <div class="container">
      <div class="row">
        <p class="mt-3" style="font-size: 2.4em; margin-bottom: 0">Tracker Info 📡</p>
        <div class="setting-btn">
          <button class="btn btn-danger round mr-1" data-toggle="modal" data-target="#delete_modal">Delete Tracker 🗑️</button>
          <button class="btn btn-info round" data-toggle="modal" data-target="#change_url_modal">Change Original URL 🔗</button>
        </div>
        <div class="input-group mt-1">
          <div class="input-group-prepend">
            <span class="input-group-text inpt-group-span">Link ID</span>
          </div>
          input(type="text" class="form-control inpt-group-input inpt-group-input-1" value=tracker_info.id readonly)
          <button class="btn btn-info inpt-group-btn" onclick="copyText(1)" >Copy 📋</button>
        </div>
        <div class="input-group mt-1">
          <div class="input-group-prepend">
            <span class="input-group-text inpt-group-span">Tracker ID</span>
          </div>
          input(type="text" class="form-control inpt-group-input inpt-group-input-2" value=tracker_info.admin_id readonly)
          <button class="btn btn-info inpt-group-btn" onclick="copyText(2)" >Copy 📋</button>
        </div>
        <div class="input-group mt-1">
          <div class="input-group-prepend">
            <span class="input-group-text inpt-group-span">Original URL</span>
          </div>
          input(type="text" class="form-control inpt-group-input inpt-group-input-3" value=tracker_info.original_url readonly)
          <button class="btn btn-info inpt-group-btn" onclick="copyText(3)" >Copy 📋</button>
        </div>
        <div class="input-group mt-1">
          <div class="input-group-prepend">
            <span class="input-group-text inpt-group-span">Short URL</span>
          </div>
          input(type="text" class="form-control inpt-group-input inpt-group-input-4" value=tracker_info.short_url readonly)
          <button class="btn btn-info inpt-group-btn" onclick="copyText(4)" >Copy 📋</button>
        </div>
        <div class="input-group mt-1">
          <div class="input-group-prepend">
            <span class="input-group-text inpt-group-span">Tracker URL</span>
          </div>
          input(type="text" class="form-control inpt-group-input inpt-group-input-5" value=tracker_info.tracking_url readonly)
          <button class="btn btn-info inpt-group-btn" onclick="copyText(5)" >Copy 📋</button>
        </div>
      </div>
      <div class="row">
        <p class="mt-3" style="font-size: 2.4em">Captures:&nbsp;
          span= ip_info.length
        </p>
      </div>
    <table class="" id="main_table" style="width: 100%">
      <thead>
        <tr>
          <th>IP address</th>
          <th>Time Captured</th>
          <th>OS</th>
          <th>Extra</th>
        </tr>
      </thead>
      <tbody>
        each val in ip_info
          <tr>
            td= val.ip_address
            td= val.time_captured
            td= val.os
            <td>
              button(class="btn btn-info more_btn round" onclick="show_info('" + val.unique_id + "')") More&nbsp;📈
            </td>
          </tr>
      </tbody>
    </table>
    </div>
    <div class="modal fade" id="info_modal">
      <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Full Information 📈</h5>
            <button type="button" class="close" data-dismiss="modal">
              <span>❌</span>
            </button>
          </div>
          <div class="modal-body" id="info_modal_body"></div>
        </div>
      </div>
    </div>
    <div class="modal fade" id="delete_modal">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Are You Sure 🤔</h5>
            <button type="button" class="close" data-dismiss="modal">
              <span>❌</span>
            </button>
          </div>
          <div class="modal-body" id="delete_modal_body">
            <p>By clicking the button you delete this tracker and all info associated with it</p>
            <p>All captures will be deleted from our database and any URLs generated by this service will stop working</p>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary round" data-dismiss="modal">Cancel 🚫</button>
            form(action="/delete/" + tracker_info.admin_id method="get")
              <button type="submit" class="btn btn-danger round">Delete Tracker 🗑️</button>
          </div>
        </div>
      </div>
    </div>
    <div class="modal fade" id="change_url_modal">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Change URL 🌐</h5>
            <button type="button" class="close" data-dismiss="modal">
              <span>❌</span>
            </button>
          </div>
          <div class="modal-body" id="change_url_modal_body">
            <input type="url" class="form-control inpt-group-input" id="change_url_inpt" placeholder="Enter a new URL" oninput="changeURLfunc()">
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary round" data-dismiss="modal">Cancel 🚫</button>
            <a type="button" id="change_url_form" class="btn btn-success round disabled change-url" href="">Save 💾</a>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
